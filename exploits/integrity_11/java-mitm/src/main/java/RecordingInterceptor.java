import okio.BufferedSink;

import java.io.IOException;
import java.util.ArrayList;
import java.util.Collections;
import java.util.List;

public class RecordingInterceptor extends LoggingInterceptor {

    private final List<byte[]> serverToClientBytes = Collections.synchronizedList(new ArrayList<>());
    private final List<byte[]> clientToServerBytes = Collections.synchronizedList(new ArrayList<>());

    @Override
    public boolean serverToClient(byte[] bytes, BufferedSink replySink, BufferedSink forwardSink) throws IOException {
        serverToClientBytes.add(bytes.clone());
        return super.serverToClient(bytes, replySink, forwardSink);
    }

    @Override
    public boolean clientToServer(byte[] bytes, BufferedSink replySink, BufferedSink forwardSink) throws IOException {
        clientToServerBytes.add(bytes.clone());
        return super.clientToServer(bytes, replySink, forwardSink);
    }

    public List<byte[]> getServerToClientBytes() {
        return Collections.unmodifiableList(serverToClientBytes);
    }

    public List<byte[]> getClientToServerBytes() {
        return Collections.unmodifiableList(clientToServerBytes);
    }
}
